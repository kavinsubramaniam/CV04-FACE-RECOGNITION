<!DOCTYPE html>
<html>
<head>
    <title>Real-Time Face Recognition</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background-image: url("{{url_for('static', filename='/background.png')}}");
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }1
    </style>
</head>
<body class="bg-light text-black">
    <div class="container py-4">
        <h2 class="mb-4">üé• Real-Time Face Recognition</h2>
        <div style="display:flex;gap:20px">
            <img src="{{ url_for('video_feed') }}" width="50%" class="rounded shadow mb-3">
            <div id="student-info">
                <h4>Detected Name: <span id="detected-name" class="text-black">Loading...</span></h4>
                <p><strong>Roll No:</strong> <span id="roll"></span></p>
                <p><strong>Department:</strong> <span id="dept"></span></p>
            </div>
            
        </div>

        <form method="POST" action="/register" class="mt-4">
            <h4 class="text-dark">üìù Register New Student</h4>
            <div class="row g-2">
                <div class="col-md-3">
                    <input type="text" name="name" placeholder="Name" class="form-control" required>
                </div>
                <div class="col-md-3">
                    <input type="text" name="roll" placeholder="Roll Number" class="form-control" required>
                </div>
                <div class="col-md-3">
                    <input type="text" name="dept" placeholder="Department" class="form-control" required>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-success w-100" type="submit">üì∏ Register Face</button>
                </div>
            </div>
        </form>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="mt-3">
              {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}
    </div>
    <script>
        function updateInfo() {
            fetch('/get_recognized_info')
                .then(response => response.json())
                .then(data => {
                    document.getElementById("detected-name").innerText = data.name || "Unknown";
                    document.getElementById("roll").innerText = data.info.roll || "-";
                    document.getElementById("dept").innerText = data.info.dept || "-";
                })
                .catch(error => console.error("Error fetching info:", error));
        }
    
        setInterval(updateInfo, 2000);  // Fetch every 2 seconds
        updateInfo();  // Initial call
    </script>
</body>
</html>
